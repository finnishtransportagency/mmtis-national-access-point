{% ckan_extends %}

{% block resource_actions_inner %}
{% if res.url and h.is_url(res.url) %}
<li>
  <a class="btn btn-primary resource-url-analytics resource-type-{{ res.resource_type }}" href="{{ res.url }}">
    {% if res.resource_type in ('listing', 'service') %}
    <i class="fa fa-eye"></i> {{ _('View') }}
    {% elif  res.resource_type == 'api' %}
    <i class="fa fa-key"></i> {{ _('API Endpoint') }}
    {% elif (not res.has_views or not res.can_be_previewed) and not res.url_type == 'upload' %}
    <i class="fa fa-external-link"></i> {{ _('Go to resource') }}
    {% else %}
    <i class="fa fa-arrow-circle-o-down"></i> {{ _('Download') }}
    {% endif %}
  </a>
</li>
{% endif %}
{% endblock %}

{% block resource_additional_information %}
    {% if res %}
        <section class="module">
            {% block resource_additional_information_inner %}
                <div class="module-content">
                    <h2>{{ _('Additional Information') }}</h2>
                    <table class="table table-striped table-bordered table-condensed" data-module="table-toggle-more">
                        <thead>
                        <tr>
                            <th scope="col">{{ _('Field') }}</th>
                            <th scope="col">{{ _('Value') }}</th>
                        </tr>
                        </thead>
                        <tbody>

                        <tr>
                            <th scope="row">{{ _('Data last updated') }}</th>
                            <td>
                                {% if res.last_modified %}
                                    {% snippet 'snippets/local_friendly_datetime.html', datetime_obj=res.last_modified %}
                                {% else %}
                                    {{ _('unknown') }}
                                {% endif %}
                            </td>
                        </tr>

                        <tr>
                            <th scope="row">{{ _('Metadata last updated') }}</th>
                            <td>
                                {% if res.revision_timestamp or res.created%}
                                    {% snippet 'snippets/local_friendly_datetime.html', datetime_obj=(res.revision_timestamp or res.created) %}
                                {% else %}
                                    {{ _('unknown') }}
                                {% endif %}
                            </td>
                        </tr>

                        <tr>
                            <th scope="row">{{ _('Created') }}</th>
                            <td>
                                {% if res.created %}
                                    {% snippet 'snippets/local_friendly_datetime.html', datetime_obj=res.created %}
                                {% else %}
                                    {{ _('unknown') }}
                                {% endif %}
                            </td>
                        </tr>

                        <tr>
                            <th scope="row">{{ _('Format') }}</th>
                            <td>{{ res.mimetype_inner or res.mimetype or res.format or _('unknown') }}</td>
                        </tr>
                        <tr>
                            <th scope="row">{{ _('License') }}</th>
                            <td>{% snippet "snippets/license.html", pkg_dict=pkg, text_only=True %}</td>
                        </tr>
                        {% for key, value in h.format_resource_items(res.items()) %}
                            <tr class="toggle-more"><th scope="row">{{ key }}</th><td>{{ value }}</td></tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endblock %}
        </section>
    {% endif %}
{% endblock %}

