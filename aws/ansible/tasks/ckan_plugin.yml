- name: Ensure that ckanext folder is present
  file: name=/usr/lib/ckan/default/src/ckanext state=directory owner=napote group=napote

- name: Copy NAPOTE theme CKAN plugin files
  copy: src=../../nap/docker/ckan/ckan-plugins/ckanext-napote_theme dest=/usr/lib/ckan/default/src/ckanext owner=napote group=napote

- name: Install plugin with pip
  pip:
    name: /usr/lib/ckan/default/src/ckanext/ckanext-napote_theme
    editable: yes
    virtualenv: /usr/lib/ckan/default
    virtualenv_python: python2.7

- name: Restart CKAN service
  service: name=ckan state=restarted