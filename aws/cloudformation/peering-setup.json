{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Resources": {

    "VPCPeeringConnectionCIandDev": {
            "Type": "AWS::EC2::VPCPeeringConnection",
            "Properties": {
                "VpcId": {"Ref": "CIVPCId"},
                "PeerVpcId": {"Ref": "DevVPCId"},
                "Tags": [
                  {
                    "Key": "Name",
                    "Value": "PeeringCIAndDev"
                  }
                ]
            }
    },


    "PeeringRouteCItoDevPublic" : {
      "Type" : "AWS::EC2::Route",
      "Properties" : {
        "DestinationCidrBlock": { "Ref" : "DevVPCIDCIDRRange" },
        "RouteTableId" : { "Ref" : "CIPublicNetRouteTable" },
        "VpcPeeringConnectionId" : { "Ref" : "VPCPeeringConnectionCIandDev" }
      }
    },

    "PeeringRouteDevtoCIPublic" : {
      "Type" : "AWS::EC2::Route",
      "Properties" : {
        "DestinationCidrBlock": { "Ref" : "CIVPCIDCIDRRange" },
        "RouteTableId" : { "Ref" : "DevPublicNetRouteTable" },
        "VpcPeeringConnectionId" : { "Ref" : "VPCPeeringConnectionCIandDev" }
      }
    },


    "PeeringRouteCItoDevPrivate" : {
      "Type" : "AWS::EC2::Route",
      "Properties" : {
        "DestinationCidrBlock": { "Ref" : "DevVPCIDCIDRRange" },
        "RouteTableId" : { "Ref" : "CIPrivateNetRouteTable" },
        "VpcPeeringConnectionId" : { "Ref" : "VPCPeeringConnectionCIandDev" }
      }
    },

    "PeeringRouteDevtoCIPrivate" : {
      "Type" : "AWS::EC2::Route",
      "Properties" : {
        "DestinationCidrBlock": { "Ref" : "CIVPCIDCIDRRange" },
        "RouteTableId" : { "Ref" : "DevPrivateNetRouteTable" },
        "VpcPeeringConnectionId" : { "Ref" : "VPCPeeringConnectionCIandDev" }
      }
    },

    
 },
    "Parameters": {
      "projectTag": {
        "Description": "Project Name for Tagging Purposes",
        "Type": "String",
        "Default": "napote"
    },
    "DevVPCIDCIDRRange": {
      "Description": "Dev VPC CIDR",
      "Type": "String",
      "Default": "10.44.0.0/16"
    },
    "CIVPCIDCIDRRange": {
      "Description": "CI VPC CIDR",
      "Type": "String",
      "Default": "10.55.0.0/16"
    },
    "DevPublicNetRouteTable": {
      "Description": "DevPublicNetRouteTable",
      "Type": "String",
      "Default": "omitted"
    },    
    "CIPublicNetRouteTable": {
      "Description": "CIPublicNetRouteTable",
      "Type": "String",
      "Default": "omitted"
    },
    "DevPrivateNetRouteTable": {
      "Description": "DevPublicNetRouteTable",
      "Type": "String",
      "Default": "omitted"
    },    
    "CIPrivateNetRouteTable": {
      "Description": "CIPrivateNetRouteTable",
      "Type": "String",
      "Default": "omitted"
    },
    "DevVPCId": {
      "Description": "Dev VPC Id",
      "Type": "String",
      "Default": "vpc-78270e10"
    },
    "CIVPCId": {
      "Description": "CI VPC Id",
      "Type": "String",
      "Default": "vpc-0999b061"
    }
  },
  "Outputs": {
    "PseudoOutput": {
        "Description": "PseudoOutput",
        "Value": "PseudoOutput"
    }
  },
  "Description": "Configures peering between subnets"
}
